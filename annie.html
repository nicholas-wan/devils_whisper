<!DOCTYPE html>

<html>
  <head>
    <title>Annie's Story</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale = 1.0, maximum-scale=1.0, user-scalable=no" />
    <link rel="stylesheet" href="assets/css/main.css" />
    <link rel="shortcut icon" type="image/png" href="images/favicon.png" />
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet" />
    <!-- main wavesurfer.js lib -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/wavesurfer.js/1.2.3/wavesurfer.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.0.3/styles/default.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.0.3/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
  </head>
  <body class="is-preload">
    <!-- Wrapper -->
    <div id="wrapper">
      <a href="#header" id="return-to-top" style="display: inline"><i class="icon fa-chevron-up"></i></a>

      <!-- Header -->
      <header id="header">
        <a href="index.html" class="logo icon fa-home"></a>
      </header>

      <!-- Nav -->
      <nav id="nav">
        <ul class="links">
          <li class="active"><a href="annie.html">Annie</a></li>
          <li><a href="about.html">About</a></li>
        </ul>
      </nav>

      <!-- Main -->
      <div id="main" class="homepage">
        <!-- Featured Post -->
		<article class="mainpost">
          <header class="major">
            <h2>Background</h2>
            <img src="images/student-black.png" alt="" style="width: 10%" />
            <p style="font-family: courier new">Annie</p>

            <p class="aboutblock">
              Annie is a tech savvy student. She uses smart devices like iPhone and Google Home. She tends to communicate with friends and family over WhatsApp, and is likely to send and receive
              media over WhatsApp, including photos, videos, and links.
            </p>

          </header>
        </article>

        <article class="mainpost">
          <header>
            <span class="date" style="text-align: center">July 2020</span>
            <h2 style="text-align: center">After a long school day</h2>
          </header>
          <div class="image fit">
            <img class="svimg" src="images/living_room.jpeg" alt="" style="object-fit:cover;"/>
          </div>
          <br />
          <p class="aboutblock">
            One day after school, Annie turns on her Google Home smart device to listen to some music. Annie's Google Home asks her to update the device software, but Annie was not interested and lazy
            to do so.
          </p>
          <ul class="actions special">
            <button onclick="HideFunction()" id="myBtn" class="primary">Ignore the update</button>  
            </ul>
        </article>

        <span id="hideme" style="display: none; border:none;"> 
          <article class="mainpost">
            <header>
              <span class="date" style="text-align: center"> October 2020</span>
              <h2 style="text-align: center">A few months later</h2>
            </header>
            <div class="image fit">
              <img class="svimg" src="images/whatsapp.jpeg" alt="" style="object-fit:cover;"/>
              <br />
              <p class="aboutblock">
                For a few months, Annie did not update her Google Home's software, despite the reminders from the device's application. One day, she was at home using her computer while she received a
                WhatsApp notifcation.
              </p>
            </div>
            <br />

            <div class="videorow">
              <video width="100%" onended="showButton()" controls>
                <source src="videos/annie_full_compressed.mp4" id="vid" type="video/mp4" />
                Your browser does not support the video tag.
              </video>
            </div>
            <br />
            <ul class="actions special">
              <h4 id="watchtoproceed">Watch the video to proceed</h4>

              <button onclick="HideFunction2()" id="myBtn2" class="primary" style="display: none">Why did the Google home activate?</button>
            </ul>
          </article>
          <span id="hideme2">
            <article class="mainpost">
              <header>
                <h2 style="text-align: center;">Adversarial Attack</h2>
              </header>
              <div class="image fit">
                <img class="svimg" src="https://live.staticflickr.com/747/33433114246_e160efdba1_c.jpg" alt="" style="object-fit:cover;" style='width:80%; margin:auto;'/>
                <br />
                <p class="aboutblock">
                  The advertisement contained a hidden voice attack that targetted smart home assistants. This audio was not clearly audible to annie, but was intended to <u>deceive the machine learning models</u> in smart home devices with voice command controls, such as Annie's Google Home. 
                  
                </p>
               <p class="aboutblock">Fortunately, the attacker did not have any malicious intentions and only used a benign command to "Play Music". <b>In one worst case scenario</b>, if Annie had used a smart doorlock system or alarm system, the attacker could have disabled the systems to gain entry to her house. 
                </p>
              </div>
            </article>

            <article class="mainpost">
				<header>
					<h2 style="text-align:center;">Audio Waveforms</h2>
					<div class="waveform-container">
						<div class="cardbody">
						  <h3 class="waveform-header">Clean Audio Waveform</h3>
						  <div class="card">
							<div id="waveform"></div>
						  </div>
						  <div class="card-footer">
							<button class="btn btn-primary waveform-button" onclick="wavesurfer.playPause()">
							  <i class="fa fa-play"></i>
							  Play
							</button>
						  </div>
						</div>
					  </div>
					  <br />
			
					  <div class="waveform-container">
						<div class="cardbody">
						  <h3 class="waveform-header">Adversarial Audio Waveform</h3>
						  <div class="card">
							<div id="waveform2"></div>
						  </div>
						  <div class="card-footer">
							<button class="btn btn-primary waveform-button waveform-button2" onclick="wavesurfer2.playPause()">
							  <i class="fa fa-play"></i>
							  Play
							</button>
						  </div>
						</div>
					  </div>

				</header>

			</article>
      


      <article class="mainpost">
        <header>
          <h2 style="text-align: center">Audio Analysis</h2>
        </header>
        <h3>Spectrogram Analysis
          </h3>
        <p>To understand the Hidden Audio attack, we can take a look at the Mel Spectrograms of both audios.</p>
        <ul class="actions special">
          <button onclick="HideCode()" id="codeBtn" class="primary"> <i class="fa fa-code"> </i> Code</button>
        </ul>
  
        <span id="hidecode" style="display: none; border:none;">
        <pre><code class="python">
          <span class="hljs-keyword">import</span> librosa
          <span class="hljs-keyword">import</span> librosa.display
          <span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
          <span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt
          
          n_fft = <span class="hljs-number">2048</span>
          hop_length = <span class="hljs-number">512</span>
          
          <span class="hljs-comment"># Loading the audio</span>
          filename1 = <span class="hljs-string">'audio.wav'</span>
          y1, sr1 = librosa.load(filename1)
          
          <span class="hljs-comment"># To get absolute amplitude of the short-time Fourier Transform</span>
          D1 = np.<span class="hljs-built_in">abs</span>(librosa.stft(y1, n_fft=n_fft,  hop_length=hop_length))
          
          <span class="hljs-comment"># Converting amplitude to decibels</span>
          DB1 = librosa.amplitude_to_db(D1, ref=np.<span class="hljs-built_in">max</span>)
          
          <span class="hljs-comment"># Plotting mel frequency spectrogram</span>
          plt.figure(figsize=(<span class="hljs-number">10</span>,<span class="hljs-number">7</span>))
          librosa.display.specshow(DB1, sr=sr1, hop_length=hop_length, x_axis=<span class="hljs-string">'time'</span>, y_axis=<span class="hljs-string">'log'</span>);
          plt.colorbar(<span class="hljs-built_in">format</span>=<span class="hljs-string">'%+2.0f dB'</span>);
          </code></pre>
        </span>

        <h2> What is a Spectrogram? </h2>
        <p>A spectrogram is a visual representation of sound. The y-axis represents Frequency, the x-axis represents time, and the colour represents the audio volume, where a brighter colour represents a louder volume. We plot the Spectrograms of the audios on the Mel Scale, which is a scale that shows how humans can perceive differences in tones.
        </p>
        <!-- Slideshow container -->
        <div class="slideshow-container">
          <div class="slideshow-inner">
            <div class="mySlides fade">
              <img  src='images/mel_spectrogram_adversarial_audio_labelled.png' style='width: 100%;' alt="sally lightfoot crab"/>
            </div>
            <div class="mySlides fade">
              <img  src='images/mel_spectrogram_clean_audio_labelled.png' style='width: 100%;' alt="fighting nazca boobies"/>
            </div>
            </div>
          
            <a class="prev" onclick='plusSlides(-1)' style='border:none;'>&#10094;</a>
            <a class="next" onclick='plusSlides(1)' style='border:none;'>&#10095;</a>
          </div>
          <div style='text-align: center;'>
            <span class="dot" onclick='currentSlide(1)'></span>
            <span class="dot" onclick='currentSlide(2)'></span>
          </div>
          <br>
        <h2> Differences in Mel Spectrograms </h2>

        <ol>
          <li>The adversarial attack audio is noisier than the original audio, especially in the first few seconds where the adversarial attack was injected. This can be seen by the brighter colours in the first few seconds of the adversarial example.</li>
          <li>Audio splicing was done at the high-frequency areas (4096-8192 Hz), which happened due to audio editing or processing during the injection of the adversarial attack.</li>
        </ol>



      </article>

            <article class="mainpost">

            <div class="row">
              <header>
                <h2 style="text-align: center">How can we prevent this?</h2>
              </header>
              <br />
              <ul>
                <li>Regularly update your devices to the latest build or software version. </li>
                <li>Avoid clicking on suspicious links.</li> 
                <li>Avoid forwarding chain messages and do not leave devices unattended, especially in public areas. </li>
                <li>Use a password manager like lastpass - Lastpass remembers which websites you visited and the passwords. If there is a lookalike fake website, (e.g facebo0k.com), it will not autofill the password.</li> 
                <li>If you think your password has been compromised, change your password immediately.</li>
              </ul>
            </div>
			</article>
		</span>
	</span>
      </div>

      <!-- Footer -->
      <footer id="footer">
        <section class="split contact">
          <section>
            <ul class="icons alt">
              <li>
                <a href="about.html" class="icon fa fa-info"><span class="label">About</span></a>
              </li>
            </ul>
          </section>
        </section>
      </footer>
    </div>
  </body>
</html>

<script>

var wavesurfer = WaveSurfer.create({
    container: "#waveform",
    waveColor: "#82b1ff",
    interact: false,
    barWidth: 3,
    progressColor: "#f7f7f7"
  })

  var wavesurfer2 = WaveSurfer.create({
    container: "#waveform2",
    waveColor: "#F77B72",
    interact: false,
    barWidth: 3,
    progressColor: "#f7f7f7"
  })

  wavesurfer.load("audios/01_clean.wav");
  wavesurfer2.load("audios/01.wav");

// Attach on ready listener to WaveSurfer

wavesurfer.on('ready', function () {
    // Make the container temporarily visible
    document.getElementById("hideme").style.display = '';
	document.getElementById("hideme2").style.display = '';

    // Draw the waves
    wavesurfer.drawBuffer();
	wavesurfer2.drawBuffer();

    // Hide the container once again ! Now WaveSurfer should have been rendered normally
    document.getElementById("hideme").style.display = 'none';
	document.getElementById("hideme2").style.display = 'none';

});

  function HideFunction() {
    var T = document.getElementById("hideme"),
      displayValue = "";
    if (T.style.display == "") displayValue = "none";

    T.style.display = displayValue;

    var Y = document.getElementById("myBtn"),
      displayValue = "";
    Y.style.display = "none";

    // element which needs to be scrolled to
    var element = document.querySelector("#hideme");

    // scroll to element
    element.scrollIntoView({behavior: "smooth"})

  }

  function HideFunction2() {
    var T = document.getElementById("hideme2"),
      displayValue = "";
    if (T.style.display == "") displayValue = "none";

    T.style.display = displayValue;

    var Y = document.getElementById("myBtn2"),
      displayValue = "";
    Y.style.display = "none";

    // element which needs to be scrolled to
    var element = document.querySelector("#hideme2");

    // scroll to element
    element.scrollIntoView({behavior: "smooth"})
	}

  function HideCode() {
    var T = document.getElementById("hidecode"),
      displayValue = "";
    if (T.style.display == "") displayValue = "none";

    T.style.display = displayValue;

    // element which needs to be scrolled to
    var element = document.querySelector("#codeBtn");

    // scroll to element
    element.scrollIntoView({behavior: "smooth"})
  }


  function showButton() {
    console.log("ended");
    var T = document.getElementById("myBtn2"),
      displayValue = "";
    T.style.display = "";

    var Y = document.getElementById("watchtoproceed"),
      displayValue = "";
    Y.style.display = "none";
  }

</script>
<script>
var slideIndex = 1;

var myTimer;

var slideshowContainer;

window.addEventListener("load",function() {
    showSlides(slideIndex);
    myTimer = setInterval(function(){plusSlides(1)}, 3000);
  
    //COMMENT OUT THE LINE BELOW TO KEEP ARROWS PART OF MOUSEENTER PAUSE/RESUME
    slideshowContainer = document.getElementsByClassName('slideshow-inner')[0];
  
    //UNCOMMENT OUT THE LINE BELOW TO KEEP ARROWS PART OF MOUSEENTER PAUSE/RESUME
    // slideshowContainer = document.getElementsByClassName('slideshow-container')[0];
  
    slideshowContainer.addEventListener('mouseenter', pause)
    slideshowContainer.addEventListener('mouseleave', resume)
})

// NEXT AND PREVIOUS CONTROL
function plusSlides(n){
  clearInterval(myTimer);
  if (n < 0){
    showSlides(slideIndex -= 1);
  } else {
   showSlides(slideIndex += 1); 
  }
  
  //COMMENT OUT THE LINES BELOW TO KEEP ARROWS PART OF MOUSEENTER PAUSE/RESUME
  
  if (n === -1){
    myTimer = setInterval(function(){plusSlides(n + 2)}, 3000);
  } else {
    myTimer = setInterval(function(){plusSlides(n + 1)}, 3000);
  }
}

//Controls the current slide and resets interval if needed
function currentSlide(n){
  clearInterval(myTimer);
  myTimer = setInterval(function(){plusSlides(n + 1)}, 3000);
  showSlides(slideIndex = n);
}

function showSlides(n){
  var i;
  var slides = document.getElementsByClassName("mySlides");
  var dots = document.getElementsByClassName("dot");
  if (n > slides.length) {slideIndex = 1}
  if (n < 1) {slideIndex = slides.length}
  for (i = 0; i < slides.length; i++) {
      slides[i].style.display = "none";
  }
  for (i = 0; i < dots.length; i++) {
      dots[i].className = dots[i].className.replace(" active", "");
  }
  slides[slideIndex-1].style.display = "block";
  dots[slideIndex-1].className += " active";
}

pause = () => {
  clearInterval(myTimer);
}

resume = () =>{
  clearInterval(myTimer);
  myTimer = setInterval(function(){plusSlides(slideIndex)}, 4000);
}
</script>
